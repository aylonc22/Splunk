[savedsearches]
# RAM Usage Report and Alert (Alert when RAM usage exceeds 80%)
[High_RAM_Usage_Report]
search = index=main source=PerfmonMk:Memory
| stats latest(%_Committed_Bytes_In_Use) as memory_in_use latest(Available_MBytes) as available_ram by host
| eval ram_usage = 100 - (available_ram / total_ram * 100)
| where ram_usage > 80
cron_schedule = 0 * * * *  # Run every hour
alert_type = always
alert_severity = 3  # High severity
alert_action = email
description = "This report tracks the RAM usage. Alerts when the usage exceeds 80%."
action.email.subject = "Alert: High RAM Usage"
action.email.to = "admin@example.com"
action.email.from = "splunk@domain.com"

# Low Disk Free Space Report and Alert (Alert when disk free space is below 10%)
[Low_Disk_Free_Space_Report]
search = index=main source=PerfmonMk:LogicalDisk
| stats avg(%_Free_Space) as avg_free_space by host, instance
| where avg_free_space < 10
cron_schedule = 0 * * * *  # Run every hour
alert_type = always
alert_severity = 3  # High severity
alert_action = email
description = "This report tracks the free space on disks. Alerts when the free space falls below 10%."
action.email.subject = "Alert: Low Disk Free Space"
action.email.to = "admin@example.com"
action.email.from = "splunk@domain.com"
